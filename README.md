
# Jmoordb-core-quarkus

Framework Java para bases de datos NoSQL

Esta versión esta orientada a Quarkus para crear imagenes Nativas

## Diferencias
- Utiliza quarkus-mongodb-client para conexión con MongoDB
- No utiliza jersey
- En DocumentUtil remover

```java
/**
 * Removido para Quarkkus
 */
//    // <editor-fold defaultstate="collapsed" desc="String encodeJson(String query)" >
//
//    public static String encodeJson(String query) {
//        try {
//
//            return UriComponent.encode(query, UriComponent.Type.QUERY_PARAM_SPACE_ENCODED);
//        } catch (Exception e) {
//            MessagesUtil.error(MessagesUtil.nameOfClassAndMethod() + "error: " + e.getLocalizedMessage());
//        }
//        return query;
//
//    }
//    // </editor-fold>

```
- El producer debe tener la siguiente firma

```java

import com.jmoordb.core.annotation.DateSupport;
import com.jmoordb.core.annotation.enumerations.JakartaSource;
import java.io.Serializable;
import javax.enterprise.context.ApplicationScoped;

@ApplicationScoped
@DateSupport(jakartaSource = JakartaSource.JAVAEE_LEGACY)
public class MongoDBProducer implements Serializable {
    
}

```



Agregue al archivo application.properties

```
quarkus.mongodb.connection-string = mongodb://localhost:27017
# mandatory if you don't specify the name of the database using @MongoEntity
quarkus.mongodb.database = ejemplodb

```





[Libro](http://leanpub.com/jmoordbcore)

Ejemplo

Defina una entidad

```java
Entity(jakartaSource = JakartaSource.JAVAEE_LEGACY)
public class Pais {
    @Id(autogeneratedActive = AutogeneratedActive.ON)
    private Long idpais;
    @Column
    private String pais;
    
    @Column
    private Date fecha;

    public Pais() {
    }

````

Cree una interface Repository

```java
@Repository(entity = Pais.class, jakartaSource = JakartaSource.JAVAEE_LEGACY)
public interface PaisRepository extends CrudRepository<Pais, Long> {

@Find
    public Stream<Pais> findByNombreAndApellidoAndEdadLessThanEquals(String nombre, String apellido, Integer edad);
    
    @Query(where = "fecha .eq. @fecha")
    public List<Pais> queryByFecha(@IncludeTime Date fecha);
    
    @Find
    public List<Pais> findByIdpaisGreaterThanPagination(Long idpais,Pagination pagination);
    

    @Find
    public List<Pais> findByFecha(@IncludeTime Date fecha);

    @Find
    public List<Pais> findByFecha(@ExcludeTime LocalDateTime fecha);

    @Find
    public List<Pais> findByFechaGreaterThan(Date fecha);

    @Find
    public List<Pais> findByFechaGreaterThanEquals(@ExcludeTime Date fecha);

    @Find
    public List<Pais> findByFechaLessThan(@ExcludeTime Date fecha);

    @Find
    public List<Pais> findByFechaLessThanEquals(@ExcludeTime Date fecha);

    @Find
    public Optional<Pais> findByFechaAndPais(@ExcludeTime Date fecha, String pais);

    @Find
    public List<Pais> findByFechaLessThanAndPais(@ExcludeTime Date fecha, String pais);

    @Find
    public List<Pais> findByPaisAndFechaLessThan(@ExcludeTime Date fecha, String pais);

////    
//    
    @Find
    public List<Pais> findByLocal(@ExcludeTime LocalDateTime local);
//    

    @CountBy
    public Long countByLocal(LocalDateTime local);

   
    @Find
    public List<Pais> findByFechaGreaterThanEqualsAndFechaLessThanEquals(@IncludeTime Date start, Date end);


    @Find
    public List<Pais> findByFechaGreaterThanEqualAndFechaLessThanEqual(@ExcludeTime Date start, @ExcludeTime Date end);

    @Find
    public List<Pais> findByFechaGreaterThanEqualAndFechaLessThanEqualAndPais(@ExcludeTime Date start, @ExcludeTime Date end, String pais);

    @DeleteBy
    public Long deleteByFechaGreaterThan(Date fecha);

    @Ping
    pubblic Boolean ping();
}


````

```




# Para implementar el framework en Quarkus

En el archivo pom.xml elimine

```xml

       <dependency>
            <groupId>org.mongodb</groupId>
            <artifactId>mongodb-driver-sync</artifactId>
            <version>4.0.6</version>
            <version>4.6.0</version>
        </dependency>

       <dependency>
            <groupId>org.glassfish.jersey.core</groupId>
            <artifactId>jersey-common</artifactId>
            <version>3.1.0-M3</version>
            <type>jar</type>
        </dependency>
```

agregue

```xml
            <dependency>
            <groupId>io.quarkus</groupId>
            <artifactId>quarkus-mongodb-client</artifactId>
        </dependency>




```

